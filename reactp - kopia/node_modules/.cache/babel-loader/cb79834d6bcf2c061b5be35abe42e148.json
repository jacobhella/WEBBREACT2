{"ast":null,"code":"'use strict';\n\nvar command = require('./command')();\nvar YError = require('./yerror');\nvar positionName = ['first', 'second', 'third', 'fourth', 'fifth', 'sixth'];\nmodule.exports = function argsert(expected, callerArguments, length) {\n  // TODO: should this eventually raise an exception.\n  try {\n    // preface the argument description with \"cmd\", so\n    // that we can run it through yargs' command parser.\n    var position = 0;\n    var parsed = {\n      demanded: [],\n      optional: []\n    };\n    if (typeof expected === 'object') {\n      length = callerArguments;\n      callerArguments = expected;\n    } else {\n      parsed = command.parseCommand(\"cmd \".concat(expected));\n    }\n    var args = [].slice.call(callerArguments);\n    while (args.length && args[args.length - 1] === undefined) args.pop();\n    length = length || args.length;\n    if (length < parsed.demanded.length) {\n      throw new YError(\"Not enough arguments provided. Expected \".concat(parsed.demanded.length, \" but received \").concat(args.length, \".\"));\n    }\n    var totalCommands = parsed.demanded.length + parsed.optional.length;\n    if (length > totalCommands) {\n      throw new YError(\"Too many arguments provided. Expected max \".concat(totalCommands, \" but received \").concat(length, \".\"));\n    }\n    parsed.demanded.forEach(function (demanded) {\n      var arg = args.shift();\n      var observedType = guessType(arg);\n      var matchingTypes = demanded.cmd.filter(function (type) {\n        return type === observedType || type === '*';\n      });\n      if (matchingTypes.length === 0) argumentTypeError(observedType, demanded.cmd, position, false);\n      position += 1;\n    });\n    parsed.optional.forEach(function (optional) {\n      if (args.length === 0) return;\n      var arg = args.shift();\n      var observedType = guessType(arg);\n      var matchingTypes = optional.cmd.filter(function (type) {\n        return type === observedType || type === '*';\n      });\n      if (matchingTypes.length === 0) argumentTypeError(observedType, optional.cmd, position, true);\n      position += 1;\n    });\n  } catch (err) {\n    console.warn(err.stack);\n  }\n};\nfunction guessType(arg) {\n  if (Array.isArray(arg)) {\n    return 'array';\n  } else if (arg === null) {\n    return 'null';\n  }\n  return typeof arg;\n}\nfunction argumentTypeError(observedType, allowedTypes, position, optional) {\n  throw new YError(\"Invalid \".concat(positionName[position] || 'manyith', \" argument. Expected \").concat(allowedTypes.join(' or '), \" but received \").concat(observedType, \".\"));\n}","map":null,"metadata":{},"sourceType":"script"}